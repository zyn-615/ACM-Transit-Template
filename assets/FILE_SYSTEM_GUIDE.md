# ACM中转站 - 文件管理系统使用指南

## 🎯 功能概览

ACM中转站现已支持多种文件格式的自动识别和显示，以及全新的**题解管理器**，包括：
- **题面PDF** - 比赛题目的原始PDF文件
- **题解文件** - 支持PDF和Markdown格式，带上传者标注
- **比赛文档** - 整场比赛的PDF合集和总结
- **智能管理** - 自动创建文件夹结构，规范命名

## 🆕 新版题解管理流程

### 1. 打开题解管理器
- 在**题目管理页面**点击"📝 管理题解文件"
- 或在**题目详情页面**的题解管理区域点击管理按钮
- 系统会在新窗口中打开专门的题解管理器

### 2. 添加题解文件
在题解管理器中填写：

**基本信息**：
- **上传者姓名** ⭐ - 必填，用于创建个人文件夹
- **题解类型** - 选择：官方题解/个人题解/编辑题解等
- **文件格式** - 选择：Markdown (.md) 或 PDF (.pdf)
- **题解标题** - 可选，不填写使用默认标题
- **题解描述** - 可选，描述解题方法等

**提交后系统会**：
- 自动生成标准化文件名
- 显示完整的文件路径
- 创建文件夹结构指导
- 提供文件复制说明

### 3. 文件复制指导
系统会显示类似以下的指导：

```
📁 文件复制指导
1. 创建文件夹结构：
   assets/pdfs/cf-round-885/solutions/A/

2. 将你的题解文件重命名为：
   solution-zhang.md

3. 复制到指定位置后点击"刷新状态"按钮
```

### 4. 文件状态管理
- ⏳ **待复制** - 文件条目已创建，等待文件复制
- ✅ **已完成** - 文件已正确放置，可以访问
- 🔄 **刷新状态** - 自动检查文件是否已复制到位

## 📁 文件组织结构

```
acm-transit/assets/pdfs/
├── [比赛ID]/
│   ├── problems/           # 题面文件夹
│   │   ├── A.pdf          # A题题面
│   │   ├── B.pdf          # B题题面
│   │   └── C.pdf          # C题题面
│   ├── solutions/         # 题解文件夹
│   │   ├── A/             # A题题解
│   │   │   ├── official.pdf        # 官方题解
│   │   │   ├── official.md         # 官方题解(Markdown)
│   │   │   ├── solution-zhang.pdf  # 张同学的题解
│   │   │   ├── solution-li.md      # 李同学的题解
│   │   │   └── editorial-admin.pdf # 管理员编辑的题解
│   │   ├── B/             # B题题解
│   │   │   ├── solution-wang.md
│   │   │   └── approach-chen.pdf
│   │   ├── contest-summary.md  # 整场比赛题解总结
│   │   └── contest-editorial.pdf
│   └── contest.pdf        # 比赛题面合集
└── [其他比赛]/
```

## 🏷️ 文件命名规范

### 自动生成的文件名格式：

**官方题解**：
- `official.pdf` 或 `official.md`

**个人题解**：
- `solution-[姓名].pdf` 或 `solution-[姓名].md`
- 例如：`solution-zhang.md`、`solution-li.pdf`

**其他类型**：
- `editorial-[姓名].pdf` - 编辑题解
- `approach-[姓名].md` - 解法说明
- `analysis-[姓名].pdf` - 分析文档
- `writeup-[姓名].md` - 解题报告

### 姓名处理规则：
- 自动转换为小写
- 移除特殊字符，只保留字母和数字
- 例如："张 三!" → "zhangsan"

## 🚀 快速开始指南

### 为现有题目添加题解

1. **打开题目详情页**：
   - 访问 `problem-detail.html?id=cf-round-885-a`

2. **点击"管理题解文件"按钮**：
   - 系统会打开题解管理器窗口

3. **填写题解信息**：
   ```
   上传者姓名: 张三
   题解类型: 个人题解
   文件格式: Markdown (.md)
   题解标题: A题数学解法
   题解描述: 使用数学公式直接计算
   ```

4. **点击"创建题解条目"**：
   - 系统生成文件路径：`assets/pdfs/cf-round-885/solutions/A/solution-zhangsan.md`

5. **按指导复制文件**：
   - 创建文件夹结构（或点击"创建文件夹"按钮获取指导）
   - 将你的Markdown文件重命名为 `solution-zhangsan.md`
   - 复制到指定路径

6. **验证文件状态**：
   - 点击"检查"按钮
   - 状态变为 ✅ **已完成**

## 💡 功能特性

### 智能文件管理
- **自动路径生成** - 根据比赛ID和题目字母自动生成
- **标准化命名** - 统一的文件命名规范
- **重复检测** - 避免同一作者重复添加相同类型题解
- **状态跟踪** - 实时显示文件复制状态

### 多人协作支持
- **作者标识** - 每个题解文件都标注上传者
- **类型分类** - 区分官方题解、个人题解等不同类型
- **批量管理** - 支持批量检查文件状态
- **进度显示** - 直观显示题解完成进度

### 跨平台兼容
- **相对路径** - 确保在不同电脑上路径正确
- **标准格式** - 支持主流的PDF和Markdown格式
- **浏览器友好** - 无需额外软件，浏览器直接查看

## 🛠️ 高级使用

### 批量添加题解
1. 为每个题目创建题解条目
2. 点击"创建所有文件夹"获取完整的文件夹结构
3. 按照生成的路径批量复制文件
4. 使用"刷新状态"批量检查所有文件

### 团队协作建议
1. **约定命名** - 团队成员使用一致的姓名格式
2. **分工明确** - 不同成员负责不同类型的题解
3. **定期同步** - 定期同步 `assets/pdfs/` 文件夹
4. **版本控制** - 建议将重要题解纳入版本控制

## 🎨 界面展示

### 题解管理器界面
- **题目信息卡片** - 显示当前题目的基本信息
- **添加题解表单** - 规范化的题解信息收集
- **文件夹预览** - 实时显示将要创建的文件结构
- **题解状态列表** - 管理所有题解文件的状态
- **进度指示器** - 直观显示完成进度

### 题目详情页集成
- **题目文件区域** - 显示题面PDF和相关文件
- **题解文件区域** - 显示所有已添加的题解文件
- **管理按钮** - 快速打开题解管理器

### 比赛详情页集成
- **比赛资料区域** - 显示整个比赛的所有文件
- **分类显示** - 题面、题解分别显示
- **刷新功能** - 实时更新文件状态

## 🔧 技术实现

### 文件检测机制
- 使用 `fetch()` API 的 HEAD 请求检查文件存在性
- 异步批量检查，提高性能
- 实时状态更新，用户体验良好

### 数据持久化
- 题解条目信息存储在 `localStorage`
- 按题目ID分别存储：`solutions-${problemId}`
- 支持导入导出，便于数据迁移

### 文件显示
- **PDF文件**：`<iframe>` 内嵌显示
- **Markdown文件**：`marked.js` 实时渲染
- **文件链接**：不同类型使用不同样式

## 📝 注意事项

### 文件管理建议
- **保持整洁** - 定期清理无用的题解条目
- **备份重要** - 重要题解建议多格式保存
- **路径一致** - 确保团队成员使用相同的路径结构

### 性能优化
- **文件大小** - PDF文件建议压缩，提高加载速度
- **批量操作** - 使用批量检查功能，避免逐个检查
- **浏览器缓存** - 利用浏览器缓存，减少重复加载

## 🆘 常见问题

**Q: 题解管理器无法打开？**
A: 检查浏览器弹窗设置，允许当前网站打开弹窗。

**Q: 文件状态一直显示"待复制"？**
A: 确认文件路径和文件名完全正确，包括大小写和扩展名。

**Q: 如何修改已添加的题解信息？**
A: 点击"删除"移除条目，然后重新添加。

**Q: 多人协作时文件冲突怎么办？**
A: 使用不同的上传者姓名，系统会自动生成不同的文件名。

**Q: 如何批量导入现有题解？**
A: 先在管理器中创建条目，再批量复制文件到对应位置。

---

## 🎉 开始使用新版题解管理

新的题解管理系统让文件组织更加规范，多人协作更加便捷！

### 立即体验：
1. 打开任意题目详情页
2. 点击"📝 管理题解文件"
3. 添加你的第一个题解
4. 享受全新的文件管理体验！

**让ACM学习更有组织，让团队协作更高效！** 🚀